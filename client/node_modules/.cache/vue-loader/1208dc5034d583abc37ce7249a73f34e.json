{"remainingRequest":"/Users/remynguyen/Documents/MIAGE/M1/Javascript/TP3/tp3/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/remynguyen/Documents/MIAGE/M1/Javascript/TP3/tp3/src/components/Accueil.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/remynguyen/Documents/MIAGE/M1/Javascript/TP3/tp3/src/components/Accueil.vue","mtime":1636054551345},{"path":"/Users/remynguyen/Documents/MIAGE/M1/Javascript/TP3/tp3/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/remynguyen/Documents/MIAGE/M1/Javascript/TP3/tp3/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/Users/remynguyen/Documents/MIAGE/M1/Javascript/TP3/tp3/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/remynguyen/Documents/MIAGE/M1/Javascript/TP3/tp3/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCBfIGZyb20gImxvZGFzaCIKZXhwb3J0IGRlZmF1bHQgewogIG5hbWU6ICdBY2N1ZWlsJywKICBkYXRhOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgcmV0dXJuewogICAgICAgICAgcmVzdGF1cmFudHM6IFtdLAogICAgICAgICAgcmVzdGF1cmFudHNBbGVhdG9pcmU6IFtdLAogICAgICAgICAgcmVzdGF1cmFudHNSZWNoZXJjaGU6IFtdLAogICAgICAgICAgcmVzdGF1cmFudHNUb3AzOiBbXSwKICAgICAgICAgIGZhdm9yaXMgOiBbXSwKICAgICAgICAgIG5vbVJlY2hlcmNoZXI6ICcnLAogICAgICAgICAgc2hvdzogZmFsc2UsCiAgICAgICAgICBub1Jlc3VsdCA6IGZhbHNlCiAgICAgICAgfQogICAgfSwKICBwcm9wczogewogICAKICB9LAogIGNvbXB1dGVkIDogewogICAgICAKICB9LAogIG1vdW50ZWQoKSB7CiAgICB0aGlzLmdldFJlc3RhdXJhbnRzRnJvbVNlcnZlcigpOwogICAgaWYobG9jYWxTdG9yYWdlLmZhdm9yaXMpIHsKICAgICAgdGhpcy5mYXZvcmlzID0gSlNPTi5wYXJzZShsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgiY2F0cyIpKTsKICAgIH0KICB9LAogIG1ldGhvZHMgOiB7CiAgICBnZXRSZXN0YXVyYW50c0Zyb21TZXJ2ZXIoKSB7CiAgICAgIGxldCB1cmwgPSAnaHR0cDovL2xvY2FsaG9zdDo4MDgwL2FwaS9yZXN0YXVyYW50cz8nOwogICAgICB1cmwgKz0gJyZwYWdlc2l6ZT0xMDAwJzsKICAgICAgdXJsICs9ICcmbmFtZT0nICsgdGhpcy5ub21SZWNoZXJjaGVyOwoKICAgICAgZmV0Y2godXJsLCB7CiAgICAgICAgICBtZXRob2Q6ICdnZXQnCiAgICAgIH0pLnRoZW4oKHJlc3BvbnNlKSA9PiB7CiAgICAgICAgICByZXNwb25zZS5qc29uKCkudGhlbigocmVzKSA9PiB7CiAgICAgICAgICAgICAgdGhpcy5yZXN0YXVyYW50cyA9IHJlcy5kYXRhOwogICAgICAgICAgICAgIHRoaXMucmVzdGF1cmFudHMuZm9yRWFjaChlbGVtZW50ID0+IHsKICAgICAgICAgICAgICAgICAgICAgICAgZWxlbWVudC5ncmFkZXNbMF0uc2NvcmUgPSBNYXRoLmZsb29yKChlbGVtZW50LmdyYWRlc1swXS5zY29yZSAqIDUpLzIwKQogICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgIHRoaXMucmFuZG9taXplKCk7CiAgICAgICAgICAgICAgdGhpcy5yZXN0YXVyYW50c0FsZWEoKTsKICAgICAgICAgICAgICB0aGlzLnRvcFJlc3RhdXJhbnQoKTsKICAgIAogICAgICAgICAgfSk7CiAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uKGVycikgewogICAgICAgICAgY29uc29sZS5sb2coZXJyKTsKICAgICAgfSk7CiAgICAgIAogICAgICAgICAgICAKICAgIH0sCiAgICBnZXRTZWFyY2hlZFJlc3RhdXJhbnRzKCkgewogICAgICB0aGlzLnNob3cgPSBmYWxzZTsKICAgICAgdGhpcy5ub1Jlc3VsdD1mYWxzZTsKICAgICAgCiAgICAgIGlmKHRoaXMubm9tUmVjaGVyY2hlciA9PSAnJyl7CiAgICAgICAgdGhpcy5yZXN0YXVyYW50c1JlY2hlcmNoZSA9IFtdOwogICAgICB9CiAgICAgIGVsc2V7CiAgICAgICAgdGhpcy5zaG93ID0gdHJ1ZTsKICAgICAgICBsZXQgdXJsID0gJ2h0dHA6Ly9sb2NhbGhvc3Q6ODA4MC9hcGkvcmVzdGF1cmFudHM/JzsKICAgICAgICB1cmwgKz0gJ3BhZ2VzaXplPScgKyAzOwogICAgICAgIHVybCArPSAnJm5hbWU9JyArIHRoaXMubm9tUmVjaGVyY2hlcjsKCiAgICAgICAgZmV0Y2godXJsLCB7CiAgICAgICAgICAgIG1ldGhvZDogJ2dldCcKICAgICAgICB9KS50aGVuKChyZXNwb25zZSkgPT4gewogICAgICAgICAgICByZXNwb25zZS5qc29uKCkudGhlbigocmVzKSA9PiB7CiAgICAgICAgICAgICAgICB0aGlzLnJlc3RhdXJhbnRzUmVjaGVyY2hlID0gcmVzLmRhdGE7CiAgICAgICAgICAgICAgICB0aGlzLnJlc3RhdXJhbnRzLmZvckVhY2goZWxlbWVudCA9PiB7CiAgICAgICAgICAgICAgICAgICAgICAgIGVsZW1lbnQuZ3JhZGVzWzBdLnNjb3JlID0gTWF0aC5mbG9vcigoZWxlbWVudC5ncmFkZXNbMF0uc2NvcmUgKiA1KS8yMCkKICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIGlmKHJlcy5kYXRhLmxlbmd0aCA9PSAwKXsKICAgICAgICAgICAgICAgICAgdGhpcy5zaG93ID0gZmFsc2U7CiAgICAgICAgICAgICAgICAgIHRoaXMubm9SZXN1bHQgPSB0cnVlOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgCiAgICAgICAgICAgIH0pOwogICAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uKGVycikgewogICAgICAgICAgICBjb25zb2xlLmxvZyhlcnIpOwogICAgICAgIH0pOwogICAgICB9CiAgICB9LAogICAgcmFuZG9taXplKCkgewogICAgICAgIGZvciAobGV0IGkgPSB0aGlzLnJlc3RhdXJhbnRzLmxlbmd0aCAtIDE7IGkgPiAwOyBpLS0pIHsKICAgICAgICAgIGxldCByYW5kb21JbmRleCA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIGkpCiAgICAgICAgICBsZXQgdGVtcCA9IHRoaXMucmVzdGF1cmFudHNbaV0KICAgICAgICAgIHRoaXMuJHNldCh0aGlzLnJlc3RhdXJhbnRzLCBpLCB0aGlzLnJlc3RhdXJhbnRzW3JhbmRvbUluZGV4XSkKICAgICAgICAgIHRoaXMuJHNldCh0aGlzLnJlc3RhdXJhbnRzLCByYW5kb21JbmRleCwgdGVtcCkKICAgICAgICAgIAogICAgICAgIH0KICAgICAgICAKICAgIH0sCiAgICByZXN0YXVyYW50c0FsZWEoKSB7CiAgICAgIGZvcihsZXQgaSA9IDA7IGk8MTAgOyBpKyspIHsKICAgICAgICB0aGlzLnJlc3RhdXJhbnRzQWxlYXRvaXJlLnB1c2godGhpcy5yZXN0YXVyYW50c1tpXSk7CiAgICAgIH0KICAgIH0sCiAgICB0b3BSZXN0YXVyYW50KCl7CiAgICAgIGxldCBpID0gMDsKICAgICAgbGV0IHRvcCA9IDA7CiAgICAgIHdoaWxlKHRvcDwzICYmIHRoaXMucmVzdGF1cmFudHNbaV0gIT0gdW5kZWZpbmVkKXsKICAgICAgICBpZih0aGlzLnJlc3RhdXJhbnRzW2ldLm5vdGUgPT0gNSB8fCB0aGlzLnJlc3RhdXJhbnRzW2ldLm5vdGUgPT0gNCl7CiAgICAgICAgICB0aGlzLnJlc3RhdXJhbnRzVG9wMy5wdXNoKHRoaXMucmVzdGF1cmFudHNbaV0pOwogICAgICAgICAgdG9wKys7CiAgICAgICAgfQogICAgICAgIGkrKzsKICAgICAgfQogICAgfSwKICAgIGlzRmF2b3JpcyhpZCkgewogICAgICAgIGlmKGxvY2FsU3RvcmFnZS5nZXRJdGVtKCJmYXZvcmlzIikpewogICAgICAgICAgICBsZXQgZmF2b3JpcyA9IEpTT04ucGFyc2UobG9jYWxTdG9yYWdlLmdldEl0ZW0oImZhdm9yaXMiKSk7CiAgICAgICAgICAgIHJldHVybiBmYXZvcmlzLmluZGV4T2YoaWQpID49IDA7CiAgICAgICAgfQogICAgICAgIHJldHVybiBmYWxzZTsKICAgIH0sCiAgICBjaGVyY2hlclJlc3RhdXJhbnRzOiAgXy5kZWJvdW5jZShmdW5jdGlvbigpe3RoaXMuZ2V0U2VhcmNoZWRSZXN0YXVyYW50cygpO30sMzAwKQogIH0KfQo="},{"version":3,"sources":["Accueil.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAoEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Accueil.vue","sourceRoot":"src/components","sourcesContent":["<template>\n  <div class=\"Accueil\">\n\n      <div class=\"recherche\">\n        <h2 style=\"margin-bottom: 5%; margin-left: 20%; text-align: left;\">Que voulez-vous manger ?</h2>\n        <md-field>\n          <label>Restaurants</label>\n            <md-input @input=\"chercherRestaurants\" type=\"texte\" v-model=\"nomRechercher\"></md-input>\n          </md-field>\n\n        <md-table v-model=\"restaurantsRecherche\" v-show=\"show\">\n          <md-table-row slot=\"md-table-row\" slot-scope=\"{ item }\" v-on:click=\"$router.push('/RestaurantDetails/' + item._id)\">\n            <md-table-cell>{{ item.name }}</md-table-cell>\n            <md-table-cell>{{ item.cuisine }}</md-table-cell>\n            <md-table-cell><img src=\"../assets/heart-icon.png\" alt=\"LIKED\" width=\"10px\" v-if=\"isFavoris(item._id)\"></md-table-cell>\n          </md-table-row>\n        </md-table>\n\n        <p v-show=\"noResult\">Aucun résultat</p>\n      </div>\n\n      \n      <div class=\"top3\">\n        <h2>Les mieux notés!</h2>  \n        <md-card v-for=\"item in restaurantsTop3\" :key=\"item\" >\n          <router-link :to=\"'/restaurant/' + item._id\">\n            <md-card-media-cover md-text-scrim>\n                <md-card-media md-ratio=\"16:9\">\n                  <img v-bind:src=\"'https://loremflickr.com/1024/576/food,street,restaurant,cafe&id=' + item._id\" alt=\"Restaurant\">\n                </md-card-media>\n        \n                <md-card-area>\n                  <md-card-header>\n                    <span class=\"md-title\">{{item.name}}</span>\n                    <span class=\"md-subhead\">{{item.cuisine}}</span>\n                    <span class=\"md-subhead\">{{item.note}} Étoiles</span>\n                  </md-card-header>\n                </md-card-area>\n              </md-card-media-cover>\n          </router-link>\n            \n          </md-card>\n\n      </div>\n\n    <div class=\"md-layout md-gutter\">\n    <div class=\"md-layout-item md-size-20\"></div>\n    <div class=\"md-layout-item\">\n      <md-table v-model=\"restaurantsAleatoire\" md-card>\n            <md-table-toolbar>\n              <h1 class=\"md-title\">Restaurants aux hasards</h1>\n            </md-table-toolbar>\n          \n            <md-table-row slot=\"md-table-row\" slot-scope=\"{ item }\" @click=\"$router.push('/RestaurantDetails/' + item._id)\">\n              <md-table-cell md-label=\"Nom\">{{ item.name }}</md-table-cell>\n              <md-table-cell md-label=\"Cuisine\">{{ item.cuisine }}</md-table-cell>\n              <md-table-cell md-label=\"Note\" md-sort-by=\"note\"><i class=\"el-icon-star-on\" v-for=\"note in item.grades[0].score\" :key=\"note\"></i></md-table-cell>\n              <md-table-cell><img src=\"../assets/heart-icon.png\" alt=\"LIKED\" width=\"10px\" v-if=\"isFavoris(item._id)\"></md-table-cell>\n            </md-table-row>\n        </md-table>\n    </div>\n    <div class=\"md-layout-item md-size-20\"></div>\n  </div>\n\n  </div>\n</template>\n\n<script>\nimport _ from \"lodash\"\nexport default {\n  name: 'Accueil',\n  data: function () {\n        return{\n          restaurants: [],\n          restaurantsAleatoire: [],\n          restaurantsRecherche: [],\n          restaurantsTop3: [],\n          favoris : [],\n          nomRechercher: '',\n          show: false,\n          noResult : false\n        }\n    },\n  props: {\n   \n  },\n  computed : {\n      \n  },\n  mounted() {\n    this.getRestaurantsFromServer();\n    if(localStorage.favoris) {\n      this.favoris = JSON.parse(localStorage.getItem(\"cats\"));\n    }\n  },\n  methods : {\n    getRestaurantsFromServer() {\n      let url = 'http://localhost:8080/api/restaurants?';\n      url += '&pagesize=1000';\n      url += '&name=' + this.nomRechercher;\n\n      fetch(url, {\n          method: 'get'\n      }).then((response) => {\n          response.json().then((res) => {\n              this.restaurants = res.data;\n              this.restaurants.forEach(element => {\n                        element.grades[0].score = Math.floor((element.grades[0].score * 5)/20)\n                    });\n              this.randomize();\n              this.restaurantsAlea();\n              this.topRestaurant();\n    \n          });\n      }).catch(function(err) {\n          console.log(err);\n      });\n      \n            \n    },\n    getSearchedRestaurants() {\n      this.show = false;\n      this.noResult=false;\n      \n      if(this.nomRechercher == ''){\n        this.restaurantsRecherche = [];\n      }\n      else{\n        this.show = true;\n        let url = 'http://localhost:8080/api/restaurants?';\n        url += 'pagesize=' + 3;\n        url += '&name=' + this.nomRechercher;\n\n        fetch(url, {\n            method: 'get'\n        }).then((response) => {\n            response.json().then((res) => {\n                this.restaurantsRecherche = res.data;\n                this.restaurants.forEach(element => {\n                        element.grades[0].score = Math.floor((element.grades[0].score * 5)/20)\n                    });\n                if(res.data.length == 0){\n                  this.show = false;\n                  this.noResult = true;\n                }\n                \n            });\n        }).catch(function(err) {\n            console.log(err);\n        });\n      }\n    },\n    randomize() {\n        for (let i = this.restaurants.length - 1; i > 0; i--) {\n          let randomIndex = Math.floor(Math.random() * i)\n          let temp = this.restaurants[i]\n          this.$set(this.restaurants, i, this.restaurants[randomIndex])\n          this.$set(this.restaurants, randomIndex, temp)\n          \n        }\n        \n    },\n    restaurantsAlea() {\n      for(let i = 0; i<10 ; i++) {\n        this.restaurantsAleatoire.push(this.restaurants[i]);\n      }\n    },\n    topRestaurant(){\n      let i = 0;\n      let top = 0;\n      while(top<3 && this.restaurants[i] != undefined){\n        if(this.restaurants[i].note == 5 || this.restaurants[i].note == 4){\n          this.restaurantsTop3.push(this.restaurants[i]);\n          top++;\n        }\n        i++;\n      }\n    },\n    isFavoris(id) {\n        if(localStorage.getItem(\"favoris\")){\n            let favoris = JSON.parse(localStorage.getItem(\"favoris\"));\n            return favoris.indexOf(id) >= 0;\n        }\n        return false;\n    },\n    chercherRestaurants:  _.debounce(function(){this.getSearchedRestaurants();},300)\n  }\n}\n</script>\n\n<!-- Add \"scoped\" attribute to limit CSS to this component only -->\n<style scoped>\nh3 {\n  margin: 40px 0 0;\n}\nul {\n  list-style-type: none;\n  padding: 0;\n}\nli {\n  display: inline-block;\n  margin: 0 10px;\n}\na {\n  color: #42b983;\n}\n\n\n.md-field {\n    width: 60%;\n    margin: auto;\n}\n\n.recherche {\n    padding-top: 8%;\n    padding-bottom: 8%;\n    margin: 2%;\n    margin-left: 15%;\n    margin-right: 15%;\n    background-color: white;\n    border-radius: 10px;\n}\n\n.top3 {\n  margin-bottom: 4%;\n}\n\n.top3 .md-card {\n    width: 25%;\n    margin: 4px;\n    display: inline-block;\n    vertical-align: top;\n    border-radius: 20px;\n}\n\n\n</style>\n"]}]}